<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - used things-Tz</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Poppins',sans-serif; background:#f8fafc; }
        .navbar { background:linear-gradient(145deg,#1a1a2e,#16213e); padding:15px 30px; color:white; }
        .nav-container { max-width:1400px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
        .logo { display:flex; align-items:center; gap:10px; text-decoration:none; color:white; }
        .logo i { font-size:2rem; background:linear-gradient(45deg,#ff6b6b,#ff8e8e); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        .nav-links a { color:white; text-decoration:none; margin-left:20px; padding:10px 20px; border-radius:50px; }
        .nav-links a.active { background:rgba(255,107,107,0.2); color:#ff6b6b; }
        .main { max-width:800px; margin:40px auto; padding:0 20px; }
        .card { background:white; border-radius:20px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:30px; }
        h2 { margin-bottom:25px; color:#333; display:flex; align-items:center; gap:10px; }
        .form-group { margin-bottom:20px; }
        label { display:block; margin-bottom:8px; font-weight:600; color:#333; }
        input { width:100%; padding:15px; border:2px solid #e0e0e0; border-radius:10px; font-size:1rem; }
        input:focus { border-color:#ff6b6b; outline:none; }
        .btn-save {
            width:100%; padding:15px; background:linear-gradient(45deg,#ff6b6b,#ff8e8e);
            color:white; border:none; border-radius:10px; font-size:1.1rem; font-weight:700; cursor:pointer;
        }
        .switch { position:relative; display:inline-block; width:60px; height:34px; }
        .switch input { opacity:0; width:0; height:0; }
        .slider {
            position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0;
            background:#ccc; transition:.4s; border-radius:34px;
        }
        .slider:before {
            position:absolute; content:""; height:26px; width:26px; left:4px; bottom:4px;
            background:white; transition:.4s; border-radius:50%;
        }
        input:checked + .slider { background:#ff6b6b; }
        input:checked + .slider:before { transform:translateX(26px); }
        .notification-item { display:flex; justify-content:space-between; align-items:center; padding:15px 0; border-bottom:1px solid #e0e0e0; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="user-dashboard.html" class="logo"><i class="fas fa-store"></i><span>used things-Tz</span></a>
            <div class="nav-links">
                <a href="user-dashboard.html">Home</a>
                <a href="favorites.html">Favorites</a>
                <a href="my-products.html">My Products</a>
                <a href="profile-settings.html" class="active">Settings</a>
            </div>
        </div>
    </nav>
    <div class="main">
        <div class="card">
            <h2><i class="fas fa-user" style="color:#ff6b6b;"></i> Profile Information</h2>
            <form id="profileForm">
                <div class="form-group"><label>Full Name</label><input type="text" id="fullName" required></div>
                <div class="form-group"><label>Email</label><input type="email" id="email" required></div>
                <div class="form-group"><label>Phone Number</label><input type="tel" id="phone" required></div>
                <button type="submit" class="btn-save">Save Changes</button>
            </form>
        </div>

        <div class="card">
            <h2><i class="fas fa-lock" style="color:#ff6b6b;"></i> Change Password</h2>
            <form id="passwordForm">
                <div class="form-group"><label>Current Password</label><input type="password" id="currentPassword" required></div>
                <div class="form-group"><label>New Password</label><input type="password" id="newPassword" required></div>
                <div class="form-group"><label>Confirm New Password</label><input type="password" id="confirmPassword" required></div>
                <button type="submit" class="btn-save">Update Password</button>
            </form>
        </div>

        <div class="card">
            <h2><i class="fas fa-bell" style="color:#ff6b6b;"></i> Notification Preferences</h2>
            <div class="notification-item"><span>Email Notifications</span><label class="switch"><input type="checkbox" id="emailNotif" checked><span class="slider"></span></label></div>
            <div class="notification-item"><span>WhatsApp Notifications</span><label class="switch"><input type="checkbox" id="whatsappNotif" checked><span class="slider"></span></label></div>
            <div class="notification-item"><span>SMS Notifications</span><label class="switch"><input type="checkbox" id="smsNotif"><span class="slider"></span></label></div>
            <div style="margin-top:20px;"><button onclick="savePreferences()" class="btn-save">Save Preferences</button></div>
        </div>

        <div class="card">
            <h2><i class="fas fa-sign-out-alt" style="color:#ff6b6b;"></i> Account Actions</h2>
            <button onclick="logout()" style="width:100%; padding:15px; background:#ff6b6b; color:white; border:none; border-radius:10px; font-weight:600; cursor:pointer;">Logout</button>
        </div>
    </div>
    <script>
        let currentUser = null;

        function loadUser() {
            currentUser = JSON.parse(localStorage.getItem('currentUser')) || JSON.parse(sessionStorage.getItem('currentUser'));
            if (!currentUser) { window.location.href='signin.html'; return; }
            document.getElementById('fullName').value = currentUser.fullName || currentUser.full_name || '';
            document.getElementById('email').value = currentUser.email || '';
            document.getElementById('phone').value = currentUser.phoneNumber || currentUser.phone_number || '';
        }

        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            currentUser.fullName = document.getElementById('fullName').value;
            currentUser.email = document.getElementById('email').value;
            currentUser.phoneNumber = document.getElementById('phone').value;
            updateUserInStorage(currentUser);
            alert('Profile updated!');
        });

        document.getElementById('passwordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const curr = document.getElementById('currentPassword').value;
            const newp = document.getElementById('newPassword').value;
            const conf = document.getElementById('confirmPassword').value;
            if (curr !== currentUser.password) { alert('Current password incorrect'); return; }
            if (newp !== conf) { alert('New passwords do not match'); return; }
            currentUser.password = newp;
            updateUserInStorage(currentUser);
            alert('Password updated!');
        });

        function updateUserInStorage(updated) {
            let users = JSON.parse(localStorage.getItem('users')) || [];
            const idx = users.findIndex(u => u.id === updated.id);
            if (idx !== -1) users[idx] = updated;
            else users.push(updated);
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(updated));
            sessionStorage.setItem('currentUser', JSON.stringify(updated));
        }

        function savePreferences() {
            const prefs = {
                email: document.getElementById('emailNotif').checked,
                whatsapp: document.getElementById('whatsappNotif').checked,
                sms: document.getElementById('smsNotif').checked
            };
            localStorage.setItem('notificationPrefs_' + currentUser.id, JSON.stringify(prefs));
            alert('Preferences saved!');
        }

        function logout() {
            localStorage.removeItem('currentUser');
            sessionStorage.removeItem('currentUser');
            window.location.href = 'signin.html';
        }

        window.onload = loadUser;
    </script>
</body>
</html>